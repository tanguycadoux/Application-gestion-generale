{% extends "note_taking/base.html" %}

{% block extra_head %}
    {{ block.super }}
    <title>Liste des notes</title>
    {% load static %}
    <script src="{% static 'note_taking/table.js' %}" defer></script>
    <link rel="stylesheet" href="{% static 'note_taking/table.css' %}">
{% endblock extra_head %}

{% block content %}
    <h1>Liste des notes</h1>

    <p>
        {{ notes.count }} notes dans la base de donn√©es.
    </p>

    <hr>
    <form method="post" action="{% url 'note_taking:import_note' %}" enctype="multipart/form-data">
        {% csrf_token %}
        <p>
            <label for="note_import">Importer une ou plusieurs notes</label>
            <input type="file" name="note_import" id="note_import" accept=".qmd" multiple>
        </p>
        <button type="submit">Importer</button>
    </form>
    <hr>

    <table class="notes-list-table">
        <thead>
            <tr>
                <th scope="col">
                    <a class="table-column-head"
                        {% if next_sort %}
                            href="?sort={{ next_sort }}&direction={{ next_direction }}"
                        {% else %}
                            href="{% url 'note_taking:notes_list' %}"
                        {% endif %}
                    >
                        <p>
                            Date
                            {% if sort == "date" %}
                                {% if direction == "asc" %}
                                    <span>&#x1F869;</span>
                                {% elif direction == "desc" %}
                                    <span>&#x1F86B;</span>
                                {% endif %}
                            {% endif %}
                        </p>
                        <span class="table-column-head__options">
                            &centerdot;&centerdot;&centerdot;
                        </span>
                    </a>
                </th>
                <th scope="col">
                    <button class="table-column-head">
                        <p>Projets</p>
                        <span class="table-column-head__options">
                            &centerdot;&centerdot;&centerdot;
                        </span>
                    </button>
                </th>
            </tr>
        </thead>
        <tbody>
            {% for note in notes %}
                <tr>
                    <th scope="row"><a href="{% url 'note_taking:note_detail' note.pk %}">
                        {{ note.date|date:'D. j M. Y' }}
                    </a></th>
                    <td>
                        {% if note.projects %}
                            <ul class="tags-list">
                                {% for project in note.projects %}
                                    <li><a class="tag" href="{% url 'note_taking:project_detail' project.pk %}">
                                        {{ project }}
                                    </a></li>    
                                {% endfor%}
                            </ul>
                        {% endif %}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock content %}
